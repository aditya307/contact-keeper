{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\contact-keeper\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\contact-keeper\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\contact-keeper\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import React,{useReducer}from'react';import axios from'axios';import AuthContext from'./authContext';import Cookies from'js-cookie';import authReducer from'./authReducer';import{REGISTER_FAIL,USER_LOADED,REGISTER_SUCCESS,AUTH_ERROR,LOGIN_SUCCESS,LOGIN_FAIL,LOGOUT,CLEAR_ERRORS}from'../types';import setAuthToken from'../../utils/setAuthToken';var AuthState=function AuthState(props){var loadUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var jwt,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.token){setAuthToken(localStorage.token);// console.log('dsfsfsdfsfsf d sfdf');\n// console.log(localStorage.token);\n}jwt=Cookies.get('jwt');if(typeof jwt!=='undefined'){setAuthToken(jwt);console.log(jwt);console.log('Google auth');}_context.prev=3;_context.next=6;return axios.get('/api/auth');case 6:res=_context.sent;// console.log(res);\ndispatch({type:USER_LOADED,payload:res.data});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);dispatch({type:AUTH_ERROR});case 13:case\"end\":return _context.stop();}}},_callee,null,[[3,10]]);}));return function loadUser(){return _ref.apply(this,arguments);};}();var jwt=Cookies.get('jwt');var auth_Token='';if(typeof jwt!=='undefined'){auth_Token=jwt;console.log(jwt);console.log('Google auth');loadUser();}else{auth_Token=localStorage.getItem('token');console.log('native authentication');console.log(localStorage.getItem('token'));}console.log('$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');console.log(auth_Token);var initialState={token:auth_Token,isAuthenticated:null,loading:true,user:null,error:null};var _useReducer=useReducer(authReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];// Actions\n// REgister\nvar register=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(FormData){var config,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{'Content-Type':'application/json'}};_context2.prev=1;_context2.next=4;return axios.post('/api/users',FormData,config);case 4:res=_context2.sent;console.log(res.data);dispatch({type:REGISTER_SUCCESS,payload:res.data});loadUser();_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);dispatch({type:REGISTER_FAIL,payload:_context2.t0.response.data.msg});case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,10]]);}));return function register(_x){return _ref2.apply(this,arguments);};}();//Clear Errors\nvar clearErrors=function clearErrors(){return dispatch({type:CLEAR_ERRORS});};// Load User\nvar login=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(FormData){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{'Content-Type':'application/json'}};_context3.prev=1;console.log(FormData);_context3.next=5;return axios.post('/api/auth',FormData,config);case 5:res=_context3.sent;console.log(res.data);dispatch({type:LOGIN_SUCCESS,payload:res.data});loadUser();_context3.next=15;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](1);console.log(_context3.t0);dispatch({type:LOGIN_FAIL,payload:_context3.t0.response.data.msg});case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[1,11]]);}));return function login(_x2){return _ref3.apply(this,arguments);};}();var logout=function logout(){dispatch({type:LOGOUT});};return/*#__PURE__*/React.createElement(AuthContext.Provider,{value:{token:state.token,isAuthenticated:state.isAuthenticated,loading:state.loading,user:state.user,error:state.error,register:register,clearErrors:clearErrors,loadUser:loadUser,login:login,logout:logout}},props.children);};export default AuthState;","map":{"version":3,"sources":["C:/Users/Lenovo/Desktop/contact-keeper/client/src/context/auth/AuthState.js"],"names":["React","useReducer","axios","AuthContext","Cookies","authReducer","REGISTER_FAIL","USER_LOADED","REGISTER_SUCCESS","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","CLEAR_ERRORS","setAuthToken","AuthState","props","loadUser","localStorage","token","jwt","get","console","log","res","dispatch","type","payload","data","auth_Token","getItem","initialState","isAuthenticated","loading","user","error","state","register","FormData","config","headers","post","response","msg","clearErrors","login","logout","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from 'react';\r\nimport axios from 'axios';\r\nimport AuthContext from './authContext';\r\nimport Cookies from 'js-cookie';\r\nimport authReducer from './authReducer';\r\nimport {\r\n  REGISTER_FAIL,\r\n  USER_LOADED,\r\n  REGISTER_SUCCESS,\r\n  AUTH_ERROR,\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAIL,\r\n  LOGOUT,\r\n  CLEAR_ERRORS,\r\n} from '../types';\r\nimport setAuthToken from '../../utils/setAuthToken';\r\n\r\nconst AuthState = (props) => {\r\n  const loadUser = async () => {\r\n    if (localStorage.token) {\r\n      setAuthToken(localStorage.token);\r\n      // console.log('dsfsfsdfsfsf d sfdf');\r\n      // console.log(localStorage.token);\r\n    }\r\n    const jwt = Cookies.get('jwt');\r\n    if (typeof jwt !== 'undefined') {\r\n      setAuthToken(jwt);\r\n      console.log(jwt);\r\n      console.log('Google auth');\r\n    }\r\n    try {\r\n      const res = await axios.get('/api/auth');\r\n      // console.log(res);\r\n      dispatch({\r\n        type: USER_LOADED,\r\n        payload: res.data,\r\n      });\r\n    } catch (err) {\r\n      dispatch({ type: AUTH_ERROR });\r\n    }\r\n  };\r\n\r\n  const jwt = Cookies.get('jwt');\r\n  let auth_Token = '';\r\n  if (typeof jwt !== 'undefined') {\r\n    auth_Token = jwt;\r\n    console.log(jwt);\r\n    console.log('Google auth');\r\n    loadUser();\r\n  } else {\r\n    auth_Token = localStorage.getItem('token');\r\n    console.log('native authentication');\r\n    console.log(localStorage.getItem('token'));\r\n  }\r\n  console.log('$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');\r\n  console.log(auth_Token);\r\n  const initialState = {\r\n    token: auth_Token,\r\n    isAuthenticated: null,\r\n    loading: true,\r\n    user: null,\r\n    error: null,\r\n  };\r\n  const [state, dispatch] = useReducer(authReducer, initialState);\r\n  // Actions\r\n  // REgister\r\n  const register = async (FormData) => {\r\n    const config = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    };\r\n    try {\r\n      const res = await axios.post('/api/users', FormData, config);\r\n      console.log(res.data);\r\n      dispatch({\r\n        type: REGISTER_SUCCESS,\r\n        payload: res.data,\r\n      });\r\n      loadUser();\r\n    } catch (err) {\r\n      dispatch({\r\n        type: REGISTER_FAIL,\r\n        payload: err.response.data.msg,\r\n      });\r\n    }\r\n  };\r\n  //Clear Errors\r\n  const clearErrors = () => dispatch({ type: CLEAR_ERRORS });\r\n  // Load User\r\n\r\n  const login = async (FormData) => {\r\n    const config = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    };\r\n    try {\r\n      console.log(FormData);\r\n      const res = await axios.post('/api/auth', FormData, config);\r\n      console.log(res.data);\r\n      dispatch({\r\n        type: LOGIN_SUCCESS,\r\n        payload: res.data,\r\n      });\r\n      loadUser();\r\n    } catch (err) {\r\n      console.log(err);\r\n      dispatch({\r\n        type: LOGIN_FAIL,\r\n        payload: err.response.data.msg,\r\n      });\r\n    }\r\n  };\r\n  const logout = () => {\r\n    dispatch({ type: LOGOUT });\r\n  };\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        token: state.token,\r\n        isAuthenticated: state.isAuthenticated,\r\n        loading: state.loading,\r\n        user: state.user,\r\n        error: state.error,\r\n        register,\r\n        clearErrors,\r\n        loadUser,\r\n        login,\r\n        logout,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\nexport default AuthState;\r\n"]},"metadata":{},"sourceType":"module"}